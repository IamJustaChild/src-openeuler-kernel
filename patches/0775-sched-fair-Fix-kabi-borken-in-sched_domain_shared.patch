From 0583e3fcc24fcac9f7aca89d8e3d950cd735b2a2 Mon Sep 17 00:00:00 2001
From: XueSinian <xuesinian@huawei.com>
Date: Tue, 30 Jan 2024 15:06:05 +0800
Subject: [PATCH 775/776] sched/fair: Fix kabi borken in sched_domain_shared

hulk inclusion
category: bugfix
bugzilla: https://gitee.com/openeuler/kernel/issues/I61E4M
CVE: NA

--------------------------------

The sched_domain_shared structure is only used as pointer, and other
drivers don't use it directly.

Signed-off-by: Guan Jing <guanjing6@huawei.com>
Reviewed-by: zhangjialin <zhangjialin11@huawei.com>
Reviewed-by: Zhang Qiao <zhangqiao22@huawei.com>
Reviewed-by: Chen Hui <judy.chenhui@huawei.com>
Signed-off-by: Zheng Zengkai <zhengzengkai@huawei.com>
Signed-off-by: Xue Sinian <xuesinian@huawei.com>
---
 include/linux/sched/topology.h | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/include/linux/sched/topology.h b/include/linux/sched/topology.h
index 0bc030657db4..cef2edc96216 100644
--- a/include/linux/sched/topology.h
+++ b/include/linux/sched/topology.h
@@ -80,10 +80,12 @@ struct sched_domain_shared {
 	atomic_t	ref;
 	atomic_t	nr_busy_cpus;
 	int		has_idle_cores;
-	int		nr_idle_scan;
 #if defined(CONFIG_SCHED_STEAL) && !defined(__GENKSYMS__)
 	struct sparsemask *cfs_overload_cpus;
 #endif
+#ifndef __GENKSYMS__
+	int		nr_idle_scan;
+#endif
 };
 
 struct sched_domain {
-- 
2.33.0

